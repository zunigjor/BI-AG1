Volby
Po několika měsících, které jsi strávil/a čekáním na dokončení mezivýpočtů pro Tvůj výzkum, Ti došla trpělivost. Tohle přeci není možné, takhle se nedá dělat věda! Znechucen/a prostředím a podmínkami, ve kterých jsi nucen/a pracovat, ses rozhodl/a ukončit svou akademickou dráhu a vydělat konečně nějakém pořádné peníze. Třeba někdo napůl vyhořelého/ou matematika/čku zaměstná.

V poslední době se na politickém výsluní vyhřívá politický projekt jednoho nejmenovaného majitele několika galaxií, jehož bohatství pochází zejména z velkochovů blurggů a výroby zakázaných chemických hnojiv. V začátcích se mu většinu Vesmíru podařilo přesvědčit rozdáváním pečených porgů, nyní je ale jeho úspěch ohrožen. S rozšiřující se nemocí se jeho tým PR expertů a loutkových spolupracovníků nedokáže příliš dobře popasovat.

Chtě nechtě, vláda je nucena zavádět poměrně drastická opatření a zákazy, které mají za cíl snížit reprodukční číslo šířícího se viru. Na druhou stranu se zanedlouho mají konat další volby do vesmírného Senátu, které současný nejvyšší kancléř jistě nebude chtít prohrát. Jednak by přišel o moc, dále by přišly vniveč i astronomické částky, které doposud do svého politického projektu investoval, a v neposlední řadě by mohlo dojít k rozkrytí a vyšetření všech nepravostí, kterých se, nejen během své politické kariéry, dopustil.

A právě v této pro něj velice svízelné situaci jsi vycítil/a svou příležitost. Není to sice příliš v souladu s tvým přesvědčením, konec konců, Tvůj hlas vždy patřil zcela odlišným subjektům, ale příliš na výběr nemáš. Jediné, co ve svých 350 letech máš, je nedokončené doktorské vzdělání, vlhký byt a pár uspořených kreditů.

Zatímco vláda se hroutí jako domeček z karet a jednotlivé komise hoří jako papír, Ty jistě dokážeš dát dohromady algoritmus, který udrží počet nakažených na uzdě a zároveň zajistí, že si kancléř a jeho strana udrží svá teplá místečka. Tedy zejména kancléř, nikdo jiný si svým postem nemůže být pochopitelně jist, to všichni vědí. Vydal/a ses proto do centrály politické divize koncernu, kde bývá Nejvyšší většinou k zastižení. Nepřekvapilo Tě, že celé sídlo je kvůli současné situaci vzhůru nohama, ale to, že se bez větších potížích dostaneš až ke kancléři, jsi nečekal/a.

Ihned po přednesení Tvého návrhu jsi získal novou práci. Prostorná kancelář, přístup k nejvýkonějším počítačům, káva zdarma, špinavý zisk a prázdná sláva přeci za tu trochu přesvědčení a morálních zásad stojí. Okamžitě ses pustil/a do práce.

Nejdříve se pouštíš do analýzy nastálé situace. Tým kancléřových poradců dal dohromady seznam opatření, které je možné zavést. U každého pravidla je vypočten jeho předpokládaný vliv na reprodukční číslo viru a na vzorku několika málo dobrovolníků z řad žijících Ujgurů došlo i k zjištění očekávané změny popularity při zavedení pravidla, při jeho dlouhodobém nasazení a při jeho zrušení. Navíc víš, že jednání Senátu probíhají každé pondělí, opatření budou tedy vždy v platnosti minimálně jeden týden. Senátoři za jednotlivé obvody navíc nejsou ochotni se zúčastnit více, než jednoho hlasování za týden. Normálně by Ti to hrálo do karet, nyní to ale znamená, že každý týden je možné zavést, nebo zrušit nejvýše jedno opatření. Aby toho nebylo málo, tak bylo zjištěno, že znovuzavedení nějakého opatření má tak devastující vliv na vaši popularitu, že ani nemá cenu se o něco takového snažit.

I ty patříš mezi fanoušky známého hesla “nas mnógo”, nicméně většina obyvatel civilizovaného Vesmíru to tak necítí. Je tedy třeba dobře vyvažovat počet nakažených a aktuální popularitu. Například pokud by počet nakažených překonal magickou hranici 2^30 vyšších tvorů, pak dojde ke vzpouře. Podobně pokud by naše popularita kdykoliv klesla pod hodnotu 0, pak podle průzkumů dojde k defenestraci celého vedení Senátu. Naopak, pokud by měla popularita vystoupat nad 100, tak se zastaví na 100. Růst počtu nakažených se počítá na konci každého týdne. Tento počet získáme pomocí následujícího vzorce: dolní celá část z (0.00000001 + # nakažených v minuém týdnu * (R * dR za každé aktivní pravidlo))).

Nadcházející Senátní volby nejsou jediné, které se mají v brzké době konat. Čekají nás i další volby, kterými musíš Ty stranu bez ztráty kytičky protáhnout. U každých voleb víme, kolik procent popularity musíme v týden voleb mít. Pokud bychom náhodou tohoto čísla nedosáhli, pak budeme nahrazeni jinou stranou a nejspíše nás všechny zavřou. Máme ale zaručeno, že každý týden se konají nejvýše jedny volby. Volby se konají vždy ve středu, tj. po úpravě pravidel a započtení změny popularity.

Tvým úkolem je tedy napsat algoritmus, který vypíše libovolnou sekvenci zavádění a rušení opatření splňující podmínky výše takovou, že zůstaneme ve vládě (nebude ani moc nakažených, ani nízká popularita, a vyhrajeme všechny volby) a ve které bude na konci sledovaného období minimální počet nakažených. První pravidlo můžeme zavést nejdříve začátkem druhého týdne. Může se stát, že situace je natolik špatná, že takovou sekvenci nelze nalézt. I takový případ by měl program detekovat, ať máme dost času pobrat, co ještě nesebral nikdo jiný, a zmizet.

Formát vstupu
Vstup obsahuje více testovacích dat, na prvním řádku je číslo T, které udává počet vstupů, které musí váš program zpracovat.

Každý testovací vstup začíná řádkem obsahujícím sedmici čísel: N, A, O, P, F, V a R, kde N je počet týdnů sledovaného období, A je nejvyšší počet zároveň aktivních opatření, O je počet možných opatření, které dostaneme na vstupu později, P je počet voleb, které dostaneme na vstupu později, F je naše počáteční popularita, V je počet nakažených na konci prvního týdne, R je globální rychlost šíření nákazy (desetinné číslo). Všechna tyto čísla, kromě R, jsou celá čísla. Následuje O řádků, každý popisující jedno možné pravidlo čtyřmi čísly: první tři jsou změna popularity při zavedení / aktivním / zrušení opatření, a poslední je desetinné číslo dR, tj. číslo, kterým přenásobíme R, pokud je ono opatření aktivní. Změna popularity je vždy celé číslo. Dále následuje P řádků popisující volby: pro každé je první číslo týden voleb, a druhé je minimální požadovaná popularita, abychom je vyhráli.

Vždy platí, že:
T ≤ 100
N ≤ 100
A ≤ 5
O ≤ 6
0 ≤ P ≤ N-1
0 ≤ F ≤ 100
0 ≤ V ≤ 200000
0 < R < 4
0 < dR < 2

Desetinná čísla jsou uvedena s přesností na setiny.

Formát výstupu
Na prvním řádku výstupu vypište počet změn opatření Z a počet nakažených při zavedení tohoto plánu. Na každém z dalších Z řádků vypište 3 informace – týden, ve kterém bude změna opatření provedena, typ změny opatření zavest nebo zrusit, a číslo opatření, kterého se změna týká (číslo od 0 do O - 1). Pokud sekvence neexistuje, vypište -1.

Ukázka práce programu
Ukázkový vstup 1
1
8 2 3 1 50 10000 2.0
0 0 0 0.8
0 0 0 0.9
0 -1 2 0.6
7 50
 
Ukázkový výstup 1
4 46962
2 zavest 0
3 zavest 2
6 zrusit 2
7 zavest 1
Počty nakažených se v průběhu týdnů mění následovně: 16000, 15360, 14745, 14155, 22648, 32613, a nakonec 46962.

Ukázkový vstup 2
1
7 1 1 1 100 10000 1.4
1 100 10 0.9
7 10
 
Ukázkový výstup 2
1 40011
2 zavest 0
Ukázkový vstup 3
1
11 3 3 2 5 10000 1.4
0 1 -8 1.1
3 0 0 1.1
30 0 0 1.2
3 20
7 40
 
Ukázkový výstup 3
6 508190
3 zavest 2
4 zrusit 2
5 zavest 0
6 zavest 1
7 zrusit 1
8 zrusit 0
Ukázkový vstup 4
1
6 1 1 1 0 10000 0.9
0 10 2 0.8
6 41
 
Ukázkový výstup 4
-1
Ukázkový vstup 5
1
6 1 1 1 0 10000 0.9
1 10 0 0.8
6 41
 
Ukázkový výstup 5
1 1934
2 zavest 0
Bodové podmínky
Pro získání 1 bodu je třeba správně vyřešit instance s N ≤ 10, O ≤ 4.
Pro získání 6 bodů je třeba správně vyřešit instance s N ≤ 80, O ≤ 5.
Pro získání 10 bodů je třeba správně vyřešit instance N ≤ 100, O ≤ 6.
